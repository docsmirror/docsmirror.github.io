<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="insn.css"/><meta name="generator" content="iform.xsl"/><title>FCMLA (by element) -- A64</title></head><body><table style="margin: 0 auto;"><tr><td><div class="topbar"><a href="index.html">Base Instructions</a></div></td><td><div class="topbar"><a href="fpsimdindex.html">SIMD&amp;FP Instructions</a></div></td><td><div class="topbar"><a href="sveindex.html">SVE Instructions</a></div></td><td><div class="topbar"><a href="mortlachindex.html">SME Instructions</a></div></td><td><div class="topbar"><a href="encodingindex.html">Index by Encoding</a></div></td><td><div class="topbar"><a href="shared_pseudocode.html">Shared Pseudocode</a></div></td><td><div class="topbar"><a href="notice.html">Proprietary Notice</a></div></td></tr></table><hr/><h2 class="instruction-section">FCMLA (by element)</h2><p>Floating-point complex multiply accumulate (by element)</p>
      <p class="aml">This instruction operates on complex numbers that are represented in SIMD&amp;FP registers as pairs of elements,
with the more significant element holding the imaginary part of the number and the less significant element
holding the real part of the number. Each element holds a floating-point value. It performs the following computation
on complex numbers from the first source register and the destination register with the specified complex number from the second source register:</p>
      <ul>
        <li>
          Considering the complex number from the second source register on an Argand diagram, the number is rotated counterclockwise by 0, 90, 180, or 270 degrees.
        </li>
        <li>
          The two elements of the transformed complex number are multiplied by:<ul>
              <li>
                The real element of the complex number from the first source register, if the transformation was a rotation by 0 or 180 degrees.
              </li>
              <li>
                The imaginary element of the complex number from the first source register, if the transformation was a rotation by 90 or 270 degrees.
              </li>
            </ul>
          
        </li>
        <li>
          The complex number resulting from that multiplication is added to the complex number from the destination register.
        </li>
      </ul>
      <p class="aml">The multiplication and addition operations are performed as a fused multiply-add, without any intermediate rounding.</p>
      <p class="aml">This instruction can generate a floating-point exception.
  Depending on the settings in FPCR,
  the exception results in either a flag being set in FPSR
  or a synchronous exception being generated.
  For more information, see
  <a class="armarm-xref" title="Reference to Armv8 ARM section" data-linkend="ARMARM_BEIJDDAG">Floating-point exceptions and exception traps</a>.</p>
      <p class="aml">Depending on the settings in the CPACR_EL1,
  CPTR_EL2, and CPTR_EL3 registers,
  and the current Security state and Exception level,
  an attempt to execute the instruction might be trapped.</p>
    
    <h3 class="classheading"><a id="iclass_vector"/>Vector<span style="font-size:smaller;"><br/>(FEAT_FCMA)
          </span></h3><p class="desc"/><div class="regdiagram-32"><table class="regdiagram"><thead><tr><td>31</td><td>30</td><td>29</td><td>28</td><td>27</td><td>26</td><td>25</td><td>24</td><td>23</td><td>22</td><td>21</td><td>20</td><td>19</td><td>18</td><td>17</td><td>16</td><td>15</td><td>14</td><td>13</td><td>12</td><td>11</td><td>10</td><td>9</td><td>8</td><td>7</td><td>6</td><td>5</td><td>4</td><td>3</td><td>2</td><td>1</td><td>0</td></tr></thead><tbody><tr class="firstrow"><td class="lr">0</td><td class="lr">Q</td><td class="lr">1</td><td class="lr">0</td><td class="l">1</td><td>1</td><td class="r">1</td><td class="lr">1</td><td colspan="2" class="lr">size</td><td class="lr">L</td><td class="lr">M</td><td colspan="4" class="lr">Rm</td><td class="lr">0</td><td colspan="2" class="lr">rot</td><td class="lr">1</td><td class="lr">H</td><td class="lr">0</td><td colspan="5" class="lr">Rn</td><td colspan="5" class="lr">Rd</td></tr><tr class="secondrow"><td/><td/><td class="droppedname">U</td><td/><td colspan="3"/><td/><td colspan="2"/><td/><td/><td colspan="4"/><td/><td colspan="2"/><td/><td/><td/><td colspan="5"/><td colspan="5"/></tr></tbody></table></div><div class="encoding"><h4 class="encoding">Encoding</h4><a id="FCMLA_advsimd_elt"/><p class="asm-code">FCMLA  <a href="#Vd" title="Is the name of the SIMD&amp;FP destination register, encoded in the &quot;Rd&quot; field.">&lt;Vd&gt;</a>.<a href="#T_option__27" title="Is an arrangement specifier, ">&lt;T&gt;</a>, <a href="#Vn__2" title="Is the name of the first SIMD&amp;FP source register, encoded in the &quot;Rn&quot; field.">&lt;Vn&gt;</a>.<a href="#T_option__27" title="Is an arrangement specifier, ">&lt;T&gt;</a>, <a href="#M_Rm" title="For the &quot;Scalar, single-precision and double-precision&quot; and &quot;Vector, single-precision and double-precision&quot; variants: is the name of the second SIMD&amp;FP source register, encoded in the &quot;M:Rm&quot; fields.">&lt;Vm&gt;</a>.<a href="#Ts_option__5" title="Is an element size specifier, ">&lt;Ts&gt;</a>[<a href="#index_option__3" title="Is the element index, ">&lt;index&gt;</a>], #<a href="#rotate_option" title="Is the rotation, ">&lt;rotate&gt;</a></p></div><h4>Decode for this encoding</h4><p class="pseudocode">if !IsFeatureImplemented(FEAT_FCMA) then EndOfDecode(<a href="shared_pseudocode.html#enum_Decode_UNDEF" title="">Decode_UNDEF</a>); end;
if size == '00' || size == '11' then EndOfDecode(<a href="shared_pseudocode.html#enum_Decode_UNDEF" title="">Decode_UNDEF</a>); end;
if !IsFeatureImplemented(FEAT_FP16) &amp;&amp; size == '10' then EndOfDecode(<a href="shared_pseudocode.html#enum_Decode_UNDEF" title="">Decode_UNDEF</a>); end;
if size == '10' &amp;&amp; (L == '1' || Q == '0') then EndOfDecode(<a href="shared_pseudocode.html#enum_Decode_UNDEF" title="">Decode_UNDEF</a>); end;
if size == '01' &amp;&amp; H == '1' &amp;&amp; Q == '0' then EndOfDecode(<a href="shared_pseudocode.html#enum_Decode_UNDEF" title="">Decode_UNDEF</a>); end;
let d : integer = UInt(Rd);
let n : integer = UInt(Rn);
let m : integer = UInt(M::Rm);
var index : integer;
if size == '01' then index = UInt(H::L); end;
if size == '10' then index = UInt(H); end;
let esize : integer{} = 8 &lt;&lt; UInt(size);
let datasize : integer{} = 64 &lt;&lt; UInt(Q);
let elements : integer = datasize DIV esize;</p>
  <div class="encoding-notes"/><h3 class="explanations">Assembler Symbols</h3><div class="explanations"><table><col class="asyn-l"/><col class="asyn-r"/><tr><td>&lt;Vd&gt;</td><td><a id="Vd"/>
        
          <p class="aml">Is the name of the SIMD&amp;FP destination register, encoded in the "Rd" field.</p>
        
      </td></tr></table><table><col class="asyn-l"/><col class="asyn-r"/><tr><td>&lt;T&gt;</td><td><a id="T_option__27"/>
        <p>Is an arrangement specifier, 
          encoded in
          <q>(size :: Q)</q>:
            </p>
        <table class="valuetable">
          
            <thead>
              <tr>
                <th class="bitfield">size</th>
                <th class="bitfield">Q</th>
                <th class="symbol">&lt;T&gt;</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="bitfield">00</td>
                <td class="bitfield">x</td>
                <td class="symbol">RESERVED</td>
              </tr>
              <tr>
                <td class="bitfield">01</td>
                <td class="bitfield">0</td>
                <td class="symbol">4H</td>
              </tr>
              <tr>
                <td class="bitfield">01</td>
                <td class="bitfield">1</td>
                <td class="symbol">8H</td>
              </tr>
              <tr>
                <td class="bitfield">10</td>
                <td class="bitfield">0</td>
                <td class="symbol">RESERVED</td>
              </tr>
              <tr>
                <td class="bitfield">10</td>
                <td class="bitfield">1</td>
                <td class="symbol">4S</td>
              </tr>
              <tr>
                <td class="bitfield">11</td>
                <td class="bitfield">x</td>
                <td class="symbol">RESERVED</td>
              </tr>
            </tbody>
          
        </table>
      </td></tr></table><table><col class="asyn-l"/><col class="asyn-r"/><tr><td>&lt;Vn&gt;</td><td><a id="Vn__2"/>
        
          <p class="aml">Is the name of the first SIMD&amp;FP source register, encoded in the "Rn" field.</p>
        
      </td></tr></table><table><col class="asyn-l"/><col class="asyn-r"/><tr><td>&lt;Vm&gt;</td><td><a id="M_Rm"/>
        
          <p class="aml">Is the name of the second SIMD&amp;FP source register, encoded in the "M:Rm" fields.</p>
        
      </td></tr></table><table><col class="asyn-l"/><col class="asyn-r"/><tr><td>&lt;Ts&gt;</td><td><a id="Ts_option__5"/>
        <p>Is an element size specifier, 
          encoded in
          <q>size</q>:
            </p>
        <table class="valuetable">
          
            <thead>
              <tr>
                <th class="bitfield">size</th>
                <th class="symbol">&lt;Ts&gt;</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="bitfield">00</td>
                <td class="symbol">RESERVED</td>
              </tr>
              <tr>
                <td class="bitfield">01</td>
                <td class="symbol">H</td>
              </tr>
              <tr>
                <td class="bitfield">10</td>
                <td class="symbol">S</td>
              </tr>
              <tr>
                <td class="bitfield">11</td>
                <td class="symbol">RESERVED</td>
              </tr>
            </tbody>
          
        </table>
      </td></tr></table><table><col class="asyn-l"/><col class="asyn-r"/><tr><td>&lt;index&gt;</td><td><a id="index_option__3"/>
        <p>Is the element index, 
          encoded in
          <q>(size :: H :: L)</q>:
            </p>
        <table class="valuetable">
          
            <thead>
              <tr>
                <th class="bitfield">size</th>
                <th class="symbol">&lt;index&gt;</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="bitfield">00</td>
                <td class="symbol">RESERVED</td>
              </tr>
              <tr>
                <td class="bitfield">01</td>
                <td class="symbol">UInt(H :: L)</td>
              </tr>
              <tr>
                <td class="bitfield">10</td>
                <td class="symbol">UInt(H)</td>
              </tr>
              <tr>
                <td class="bitfield">11</td>
                <td class="symbol">RESERVED</td>
              </tr>
            </tbody>
          
        </table>
      </td></tr></table><table><col class="asyn-l"/><col class="asyn-r"/><tr><td>&lt;rotate&gt;</td><td><a id="rotate_option"/>
        <p>Is the rotation, 
          encoded in
          <q>rot</q>:
            </p>
        <table class="valuetable">
          
            <thead>
              <tr>
                <th class="bitfield">rot</th>
                <th class="symbol">&lt;rotate&gt;</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="bitfield">00</td>
                <td class="symbol">0</td>
              </tr>
              <tr>
                <td class="bitfield">01</td>
                <td class="symbol">90</td>
              </tr>
              <tr>
                <td class="bitfield">10</td>
                <td class="symbol">180</td>
              </tr>
              <tr>
                <td class="bitfield">11</td>
                <td class="symbol">270</td>
              </tr>
            </tbody>
          
        </table>
      </td></tr></table></div><div class="syntax-notes"/>
    <div class="ps"><a id=""/><h3 class="pseudocode">Operation</h3>
      <p class="pseudocode">AArch64_CheckFPAdvSIMDEnabled();
let operand1 : bits(datasize) = V{}(n);
let operand2 : bits(datasize) = V{}(m);
let operand3 : bits(datasize) = V{}(d);
var result : bits(datasize);

for e = 0 to (elements DIV 2)-1 do
    var element1 : bits(esize);
    var element2 : bits(esize);
    var element3 : bits(esize);
    var element4 : bits(esize);
    case rot of
        when '00' =&gt;
            element1 = operand2[(index*2)*:esize];
            element2 = operand1[(e*2)*:esize];
            element3 = operand2[(index*2+1)*:esize];
            element4 = operand1[(e*2)*:esize];
        when '01' =&gt;
            element1 = <a href="shared_pseudocode.html#func_FPNeg_3" title="">FPNeg</a>{esize}(operand2[(index*2+1)*:esize], FPCR());
            element2 = operand1[(e*2+1)*:esize];
            element3 = operand2[(index*2)*:esize];
            element4 = operand1[(e*2+1)*:esize];
        when '10' =&gt;
            element1 = <a href="shared_pseudocode.html#func_FPNeg_3" title="">FPNeg</a>{esize}(operand2[(index*2)*:esize], FPCR());
            element2 = operand1[(e*2)*:esize];
            element3 = <a href="shared_pseudocode.html#func_FPNeg_3" title="">FPNeg</a>{esize}(operand2[(index*2+1)*:esize], FPCR());
            element4 = operand1[(e*2)*:esize];
        when '11' =&gt;
            element1 = operand2[(index*2+1)*:esize];
            element2 = operand1[(e*2+1)*:esize];
            element3 = <a href="shared_pseudocode.html#func_FPNeg_3" title="">FPNeg</a>{esize}(operand2[(index*2)*:esize], FPCR());
            element4 = operand1[(e*2+1)*:esize];
    end;

    result[(e*2)*:esize] = <a href="shared_pseudocode.html#func_FPMulAdd_5" title="">FPMulAdd</a>{esize}(operand3[(e*2)*:esize], element2, element1, FPCR());
    result[(e*2+1)*:esize] = <a href="shared_pseudocode.html#func_FPMulAdd_5" title="">FPMulAdd</a>{esize}(operand3[(e*2+1)*:esize], element4, element3, FPCR());
end;

V{datasize}(d) = result;</p>
    </div>
  <hr/><table style="margin: 0 auto;"><tr><td><div class="topbar"><a href="index.html">Base Instructions</a></div></td><td><div class="topbar"><a href="fpsimdindex.html">SIMD&amp;FP Instructions</a></div></td><td><div class="topbar"><a href="sveindex.html">SVE Instructions</a></div></td><td><div class="topbar"><a href="mortlachindex.html">SME Instructions</a></div></td><td><div class="topbar"><a href="encodingindex.html">Index by Encoding</a></div></td><td><div class="topbar"><a href="shared_pseudocode.html">Shared Pseudocode</a></div></td><td><div class="topbar"><a href="notice.html">Proprietary Notice</a></div></td></tr></table><p class="versions">
      2025-09_rel_asl1

      2025-10-24 12:15:02
    </p><p class="copyconf">
      Copyright Â© 2010-2025 Arm Limited or its affiliates. All rights reserved.
      This document is Non-Confidential.
    </p></body></html>
